/*******************************************************************************************************************************//**
 *
 * @file		PR_PWM.c
 * @brief		Descripcion del modulo
 * @date		13 nov. 2020
 * @author		R2002 - Grupo2
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include <PR/PR_PWM.h>
#include <DR/DR_Pinsel.h>
/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/
/**
	\fn  InicializarPWM
	\brief Inicializa el driver y configura los pines "EXPANSION11" y "EXPANSION6" para PWM
 	\author R2002 - Grupo2
 	\date 13 nov. 2020
*/
void InicializarPWM(void){
	InicializarPWM_DR();

	setPinsel(EXPANSION11, FUNCION_3); //PWM chnl 2
	setPinsel(EXPANSION6, FUNCION_3); //PWM chnl 3
}


/**
	\fn  setPWMDuty
	\brief setea el duty del canal de pwm seleccioado
 	\author R2002 - Grupo2
 	\date 13 nov. 2020
 	\param [in] canal de pwm
 	\param [in] porcentaje de duty (0-100)
*/
void setPWMDuty(uint8_t n, uint16_t val){
	PWM_buff[n] = val*10;
}

/**
	\fn  setPWMOff
	\brief setea todos los canales de PWM a 0
 	\author R2002 - Grupo2
 	\date 13 nov. 2020
*/
void setPWMOff(void){
	for(uint8_t i = 0; i < CANT_PWM; i++){
		PWM_buff[i] = 0;
	}
}

/**
	\fn  getPWMDuty
	\brief devuelve el porcentaje de duty actual del canal elegido
 	\author R2002 - Grupo2
 	\date 13 nov. 2020
 	\param [in] canal a saber porcentaje de duty
	\return (uint8_t) porcentaje de duty
*/
uint8_t getPWMDuty(uint8_t n){
	return PWM_buff[n]/10;
}
