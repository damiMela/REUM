/*******************************************************************************************************************************//**
 *
 * @file		PR_Serial.c
 * @brief		Descripcion del modulo
 * @date		Nov 4, 2020
 * @author		R2002 - Grupo2
 *
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** INCLUDES
 **********************************************************************************************************************************/
#include <DR/DR_Serial.h>
#include <PR_Serial.h>

/***********************************************************************************************************************************
 *** DEFINES PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** MACROS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TIPOS DE DATOS PRIVADOS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** TABLAS PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PUBLICAS
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** VARIABLES GLOBALES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

/***********************************************************************************************************************************
 *** PROTOTIPO DE FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES PRIVADAS AL MODULO
 **********************************************************************************************************************************/

 /***********************************************************************************************************************************
 *** FUNCIONES GLOBALES AL MODULO
 **********************************************************************************************************************************/
/**
	\fn  Nombre de la Funcion
	\brief Descripcion
 	\author R2002 - Grupo2
 	\date Nov 4, 2020
 	\param [in] parametros de entrada
 	\param [out] parametros de salida
	\return tipo y descripcion de retorno
*/

void InicializarSerial(void) {
	InicializarUART0();
}

int32_t UART0_popRX(void) {
	if(UART0_rx_in == UART0_rx_out) {
		return -1;
	} else {
		int32_t ret = UART0_rx_buff[UART0_rx_out];

		UART0_rx_out++;

		if(UART0_rx_out == RX_BUFF_SIZE) {
			UART0_rx_out = 0;
		}

		return ret;
	}
}

void UART0_pushTX(uint8_t dato) {
	if(UART0_tx_flag) {
		UART0_tx_buff[UART0_tx_in] = dato;

		UART0_tx_in++;

		if(UART0_tx_in == TX_BUFF_SIZE) {
			UART0_tx_in = 0;
		}
	} else {
		UART0_forceTX(dato);
		UART0_tx_flag = 1;
	}
}
